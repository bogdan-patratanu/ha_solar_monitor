metadata:
  manufacturer: "Deye"
  model: "Three Phase"
  description: "Deye three phase hybrid inverter"
  supported_models:
    - "SUN-12K-SG04LP3-EU"
    - "SUN-15K-SG04LP3-EU"
    - "SUN-20K-SG04LP3-EU"

communication:
  default_port: 8899
  default_modbus_id: 1
  default_timeout: 10
  default_batch_size: 80
  driver: "pymodbus"

sensors:
  # Battery sensors (same as single phase)
  battery_voltage:
    address: 183
    name: "Battery Voltage"
    unit: "V"
    factor: 0.01
    icon: "mdi:battery"
    device_class: "voltage"
    state_class: "measurement"
  
  battery_soc:
    address: 184
    name: "Battery SOC"
    unit: "%"
    factor: 1
    icon: "mdi:battery"
    device_class: "battery"
    state_class: "measurement"
  
  battery_power:
    address: 190
    name: "Battery Power"
    unit: "W"
    factor: -1
    icon: "mdi:battery-charging"
    device_class: "power"
    state_class: "measurement"

  # PV sensors (multiple strings)
  pv1_voltage:
    address: 109
    name: "PV1 Voltage"
    unit: "V"
    factor: 0.1
    icon: "mdi:solar-panel"
    device_class: "voltage"
    state_class: "measurement"
  
  pv1_current:
    address: 110
    name: "PV1 Current"
    unit: "A"
    factor: 0.1
    icon: "mdi:current-dc"
    device_class: "current"
    state_class: "measurement"
  
  pv2_voltage:
    address: 111
    name: "PV2 Voltage"
    unit: "V"
    factor: 0.1
    icon: "mdi:solar-panel"
    device_class: "voltage"
    state_class: "measurement"
  
  pv2_current:
    address: 112
    name: "PV2 Current"
    unit: "A"
    factor: 0.1
    icon: "mdi:current-dc"
    device_class: "current"
    state_class: "measurement"
  
  pv_power:
    address: 186
    name: "Total PV Power"
    unit: "W"
    factor: 1
    icon: "mdi:solar-power"
    device_class: "power"
    state_class: "measurement"

  # Grid sensors - Phase A
  grid_voltage_l1:
    address: 150
    name: "Grid Voltage L1"
    unit: "V"
    factor: 0.1
    icon: "mdi:transmission-tower"
    device_class: "voltage"
    state_class: "measurement"
  
  grid_current_l1:
    address: 160
    name: "Grid Current L1"
    unit: "A"
    factor: 0.01
    icon: "mdi:current-ac"
    device_class: "current"
    state_class: "measurement"
  
  grid_power_l1:
    address: 167
    name: "Grid Power L1"
    unit: "W"
    factor: -1
    icon: "mdi:transmission-tower"
    device_class: "power"
    state_class: "measurement"

  # Grid sensors - Phase B
  grid_voltage_l2:
    address: 151
    name: "Grid Voltage L2"
    unit: "V"
    factor: 0.1
    icon: "mdi:transmission-tower"
    device_class: "voltage"
    state_class: "measurement"
  
  grid_current_l2:
    address: 161
    name: "Grid Current L2"
    unit: "A"
    factor: 0.01
    icon: "mdi:current-ac"
    device_class: "current"
    state_class: "measurement"
  
  grid_power_l2:
    address: 168
    name: "Grid Power L2"
    unit: "W"
    factor: -1
    icon: "mdi:transmission-tower"
    device_class: "power"
    state_class: "measurement"

  # Grid sensors - Phase C
  grid_voltage_l3:
    address: 152
    name: "Grid Voltage L3"
    unit: "V"
    factor: 0.1
    icon: "mdi:transmission-tower"
    device_class: "voltage"
    state_class: "measurement"
  
  grid_current_l3:
    address: 162
    name: "Grid Current L3"
    unit: "A"
    factor: 0.01
    icon: "mdi:current-ac"
    device_class: "current"
    state_class: "measurement"
  
  grid_power_l3:
    address: 169
    name: "Grid Power L3"
    unit: "W"
    factor: -1
    icon: "mdi:transmission-tower"
    device_class: "power"
    state_class: "measurement"

  # Total grid
  grid_power_total:
    address: 169
    name: "Total Grid Power"
    unit: "W"
    factor: -1
    icon: "mdi:transmission-tower"
    device_class: "power"
    state_class: "measurement"
  
  grid_frequency:
    address: 79
    name: "Grid Frequency"
    unit: "Hz"
    factor: 0.01
    icon: "mdi:sine-wave"
    state_class: "measurement"

  # Load sensors - per phase
  load_power_l1:
    address: 176
    name: "Load Power L1"
    unit: "W"
    factor: -1
    icon: "mdi:home-lightning-bolt"
    device_class: "power"
    state_class: "measurement"
  
  load_power_l2:
    address: 177
    name: "Load Power L2"
    unit: "W"
    factor: -1
    icon: "mdi:home-lightning-bolt"
    device_class: "power"
    state_class: "measurement"
  
  load_power_l3:
    address: 178
    name: "Load Power L3"
    unit: "W"
    factor: -1
    icon: "mdi:home-lightning-bolt"
    device_class: "power"
    state_class: "measurement"
  
  load_power_total:
    address: 178
    name: "Total Load Power"
    unit: "W"
    factor: -1
    icon: "mdi:home-lightning-bolt"
    device_class: "power"
    state_class: "measurement"

  # Inverter sensors
  inverter_power:
    address: 175
    name: "Inverter Power"
    unit: "W"
    factor: -1
    icon: "mdi:power-plug"
    device_class: "power"
    state_class: "measurement"

  # Energy sensors
  daily_energy:
    address: 108
    name: "Daily Energy"
    unit: "kWh"
    factor: 0.1
    icon: "mdi:solar-power"
    device_class: "energy"
    state_class: "total_increasing"
  
  total_energy:
    address: [96, 97]
    name: "Total Energy"
    unit: "kWh"
    factor: 0.1
    icon: "mdi:solar-power"
    device_class: "energy"
    state_class: "total_increasing"
    is_32bit: true

  # Temperature
  temperature:
    address: 90
    name: "Inverter Temperature"
    unit: "Â°C"
    factor: 0.1
    icon: "mdi:thermometer"
    device_class: "temperature"
    state_class: "measurement"
